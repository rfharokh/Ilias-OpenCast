mOxie.Mime.addMimeType("video/quicktime, mov");var xoctFileuploader={init:function(){mOxie.Mime.addMimeType("video/quicktime, mov");var a=new plupload.Uploader({cmd:"",runtimes:xoctFileuploaderSettings.runtimes,browse_button:xoctFileuploaderSettings.pick_button,url:xoctFileuploaderSettings.getUrl(),chunk_size:xoctFileuploaderSettings.chunk_size,unique_names:!0,has_files:!1,filters:{max_file_size:xoctFileuploaderSettings.max_file_size},multi_selection:!1,flash_swf_url:"../js/Moxie.swf",silverlight_xap_url:"../js/Moxie.xap",preinit:{Init:function(a,b){var c=this;"html5"==b.runtime?xoctWaiter.init("percentage"):xoctWaiter.init(),$(document).ready(function(){$("#form_xoct_event input[name=\"cmd[create]\"]").click(function(a){return a.preventDefault(),c.cmd=$(this).attr("name"),c.has_files?(xoctWaiter.show(),c.start()):alert(xoctFileuploaderSettings.lng.msg_select),!1}),$("#xoct_clear").click(function(){c.splice()}),$("#xoct_clear").hide()})}},init:{UploadComplete:function(a,b){var c={target_name:"",name:"",size:""};xoctWaiter.reinit("waiter"),xoctWaiter.show(),plupload.each(b,function(a){c=a}),console.log(c),$("#postvar_temp_file").val(c.target_name),$("#postvar_file_name").val(c.name),$("#postvar_size").val(c.size),$("#xoct_cmd").attr("name",this.cmd),$("#xoct_cmd").val(1),setTimeout(function(){$("#form_"+xoctFileuploaderSettings.form_id).submit()},300)},FilesAdded:function(a,b){function c(a,b){for(var c=b.length,d=0;d<c;d++)if(b[d]==a)return!0;return!1}var d=this;plupload.each(b,function(a){console.log(a),console.log(xoctFileuploaderSettings.mime_types_array),c(a.type,xoctFileuploaderSettings.mime_types_array)?(d.has_files=!0,$("#pickfiles").hide(),$("#xoct_clear").show(),$("#xoct_progress").show(),$("#xoct_file").html(a.name)):alert(xoctFileuploaderSettings.lng.msg_not_supported)})},FilesRemoved:function(a,b){plupload.each(b,function(){}),$("#xoct_file").html("&nbsp;"),$("#xoct_clear").hide(),this.has_files=!1},UploadProgress:function(a,b){var c=b.percent;xoctWaiter.setPercentage(c)}}});a.init()}},xoctFileuploaderSettings={initFromJSON:function(a){var b=this,c=JSON.parse(a);for(var d in c)b[d]=c[d];xoctFileuploader.init()},getUrl:function(){var a=/amp;/g;return console.log(this),this.url.replace(a,"")}};