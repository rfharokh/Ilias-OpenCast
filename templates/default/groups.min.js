var xoctGroup={selected_id:0,data_url:"",container:null,lng:[delete_group="Delete Group?",no_title="Please insert title",none_available="None available"],before_load:function(){},after_load:function(){},lngFromJson:function(a){this.lng=JSON.parse(a)},init:function(a,b,c,d){"undefined"!=typeof c&&(this.before_load=c),"undefined"!=typeof d&&(this.after_load=d),this.data_url=a,$(b).html("<ul id=\"xoct_groups\" class=\"list-group\"></ul>"),this.container=$("#xoct_groups"),this.load(),$(document).on("click",".xoct_group_delete",function(){xoctGroup.deleteGroup($(this).parent().data("group-id"))}),$(document).on("click",".xoct_group",function(){xoctGroup.selectGroup($(this).data("group-id"))})},clear:function(){this.container.empty(),this.selected_id=0},load:function(a,b){if(a="undefined"==typeof a?function(){}:a,b="undefined"!=typeof b&&b,b)var c=this.selected_id;var d=this;this.before_load();var e=this.data_url;$.ajax({url:e,type:"GET",data:{cmd:"getAll"}}).done(function(e){for(var f in d.clear(),e)d.container.append("<a class=\"list-group-item xoct_group\" data-group-id=\""+e[f].id+"\">"+e[f].name+"<button class=\"btn btn-danger xoct_group_delete pull-right\"><span class=\"glyphicon glyphicon-remove\"></span></button><Button class=\"btn pull-right\">"+e[f].user_count+"</button></li>");e&&0!=e.length||d.container.html("<li class=\"list-group-item\">"+d.lng.none_available+"</li>"),e&&1==e.length?d.selectGroup(e[0].id):b&&d.selectGroup(c),xoctGroupParticipant.clear(),xoctGroupParticipant.load(),d.after_load(),a()})},deleteGroup:function(a){var b=this.data_url,c=this;confirm(this.lng.delete_group)&&(this.before_load(),$.ajax({url:b,type:"GET",data:{cmd:"delete",id:a}}).done(function(b){b&&($("[data-group-id=\""+a+"\"]").remove(),c.load()),c.after_load()}))},selectGroup:function(a,b){b="undefined"!=typeof b&&b,this.selected_id!=a||b?(this.selected_id=a,this.deselectAll(),xoctGroupParticipant.load(),xoctGroupParticipant.loadForGroupId(a),$("[data-group-id=\""+a+"\"]").addClass("active")):(this.deselectAll(),this.selected_id=0)},deselectAll:function(){$(".xoct_group").each(function(){$(this).removeClass("active")}),xoctGroupParticipant.clear()},create:function(a,b){if(!a)return void alert(this.lng.no_title);var c=this,d=this.data_url;this.deselectAll(),this.before_load(),$.ajax({url:d+"&cmd=create",type:"POST",data:{title:a}}).done(function(a){c.load(function(){c.selectGroup(a.id,!0)}),c.after_load(),b(a)})}};