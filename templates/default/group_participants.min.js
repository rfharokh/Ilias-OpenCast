var xoctGroupParticipant={selected_id:0,data_url:"",container_available:null,container_per_group:null,lng:[delete_participant="Delete Participant?",select_group="Select Group",none_available="No Participants in this Group",none_available_all="No Participants available"],filter_container:null,filtering:!1,before_load:function(){},after_load:function(){},lngFromJson:function(a){this.lng=JSON.parse(a)},init:function(a,b,c,d,e){"undefined"!=typeof d&&(this.before_load=d),"undefined"!=typeof e&&(this.after_load=e),this.data_url=a,$(b).html("<ul id=\"xoct_available_participant\" class=\"list-group\"></ul>"),$(c).html("<ul id=\"xoct_group_participant\" class=\"list-group\"></ul>"),this.container_available=$("#xoct_available_participant"),this.container_per_group=$("#xoct_group_participant"),this.filter_container=$("#xoct_participant_filter"),this.load();var f=this;$(document).on("click",".xoct_add_user",function(){var a=$(this).parent().data("user-id");f.addUser(a)}),$(document).on("click",".xoct_remove_user",function(){var a=$(this).parent().data("id");f.removeUser(a)}),$.expr[":"].Contains=function(b,a,c){return 0<=$(b).text().toUpperCase().indexOf(c[3].toUpperCase())},$.expr[":"].contains=function(b,a,c){return 0<=$(b).text().toUpperCase().indexOf(c[3].toUpperCase())},this.filter_container.keyup(function(){f.filter($(this).val()),f.filtering&&!$("#xoct_filter").length?f.filter_container.after("<span class=\"input-group-btn\"><button class=\"btn btn-default\" id=\"xoct_filter\" type=\"button\"><span class=\"glyphicon glyphicon-remove\"></span> </button></span>"):!f.filtering&&$("#xoct_filter").remove()}),$(document).on("click","#xoct_filter",function(){f.filter_container.val(""),f.filter(""),$(this).remove()})},removeUser:function(a){if(confirm(this.lng.delete_participant)){this.before_load();var b=this,c=this.data_url;$.ajax({url:c+"&cmd=delete",type:"POST",data:{id:a}}).done(function(){b.after_load(),b.load(),b.loadForGroupId(xoctGroup.selected_id),xoctGroup.load(function(){},!0)})}},addUser:function(a){var b=xoctGroup.selected_id;if(0==b)return void alert(this.lng.select_group);this.before_load();var c=this,d=this.data_url;$.ajax({url:d+"&cmd=create",type:"POST",data:{user_id:a,group_id:xoctGroup.selected_id}}).done(function(){c.after_load(),c.load(),c.loadForGroupId(b),xoctGroup.load(function(){},!0)})},clear:function(){this.container_per_group.empty(),this.container_per_group.html("<li class=\"list-group-item\">"+this.lng.select_group+"</li>")},load:function(){var a=this;this.before_load();var b=this.data_url;$.ajax({url:b,type:"GET",data:{cmd:"getAvailable",group_id:xoctGroup.selected_id}}).done(function(b){for(var c in a.container_available.empty(),b)a.container_available.append("<li class=\"list-group-item xoct_participant_available\" data-user-id=\""+b[c].user_id+"\"><div style=\"margin-right:30px;\">"+b[c].name+"</div><button class=\"btn btn-primary xoct_add_user pull-right\"><span class=\"glyphicon glyphicon-plus\"></span></button></li>");b&&0!=b.length||a.container_available.html("<li class=\"list-group-item\">"+a.lng.none_available_all+"</li>"),a.after_load()})},loadForGroupId:function(a){var b=this;this.before_load();var c=this.data_url;$.ajax({url:c,type:"GET",data:{cmd:"getPerGroup",group_id:a}}).done(function(a){for(var c in b.container_per_group.empty(),a)b.container_per_group.append("<li class=\"list-group-item\" data-id=\""+a[c].id+"\"><div style=\"margin-right:30px;\">"+a[c].name+"</div><button class=\"btn btn-default xoct_remove_user pull-right\"><span class=\"glyphicon glyphicon-minus\"></span></button></li>");a&&0!=a.length||b.container_per_group.html("<li class=\"list-group-item\">"+b.lng.none_available+"</li>"),b.after_load()})},filter:function(a){this.filtering=""!=a,$(".xoct_participant_available:not(:contains(\""+a+"\"))").hide(),$(".xoct_participant_available:contains(\""+a+"\")").show()}};